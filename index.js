// telegram_bot_fixed.js
require('dotenv').config();

const fs = require('fs');
const path = require('path');
const { Bot, Keyboard } = require('grammy');

const bot = new Bot(process.env.BOT_TOKEN);
const ADMIN_ID = Number(process.env.ADMIN_ID); // ‚Üê —Ç–æ–ª—å–∫–æ —ç—Ç–∞ —Å—Ç—Ä–æ–∫–∞



// –§–∞–π–ª—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è
const adviceCooldownFile = 'daily_advice.json';
const memeIndexFile = path.join(__dirname, 'meme_index.json');

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
let userAdviceTimestamps = fs.existsSync(adviceCooldownFile)
  ? JSON.parse(fs.readFileSync(adviceCooldownFile, 'utf8'))
  : {};

let userMemeIndex = fs.existsSync(memeIndexFile)
  ? JSON.parse(fs.readFileSync(memeIndexFile, 'utf8'))
  : {};

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
function saveAdviceTimestamps() {
  fs.writeFileSync(adviceCooldownFile, JSON.stringify(userAdviceTimestamps, null, 2));
}

function saveMemeIndex() {
  fs.writeFileSync(memeIndexFile, JSON.stringify(userMemeIndex, null, 2));
}

// –ú–µ–º—ã
const memePhotos = [
  'AgACAgIAAxkBAAPCaGjbFcVkDdfrkOVyMVzHs1xtDHEAAs7zMRsfj0hLcRah7yXIqmcBAAMCAAN4AAM2BA',
  'AgACAgIAAxkBAAPEaGjbN4perbA3ufmQs7vI3vI5u6wAAs_zMRsfj0hLUFgtq22NrUEBAAMCAAN4AAM2BA',
  'AgACAgIAAxkBAAPGaGjbVR96z4cluSJ-V0njKK0vrZIAAtHzMRsfj0hLl9XXoElGDokBAAMCAAN4AAM2BA',
  'AgACAgIAAxkBAAPKaGjbm9EZi1Zswp-2K6N6VUt-uZgAAtbzMRsfj0hL85IfFAW7GUoBAAMCAAN4AAM2BA',
  'AgACAgIAAxkBAAPMaGjbtQ0hNLzvq_hKWXvU5ISYAtkAAtrzMRsfj0hL9d1QT_O9i7MBAAMCAAN4AAM2BA',
  'AgACAgIAAxkBAAPOaGjb0XhKGijQ10qvtK4mbHQOU3UAAqDyMRu0nElLvzjPng13ZxkBAAMCAAN4AAM2BA'
];

// –ú–µ–Ω—é
const mainKeyboard = new Keyboard().text('–ë–µ—Å–ø–ª–∞—Ç–Ω–æüíì').row().text('–ü–ª–∞—Ç–Ω–æü´∞').resized();

const freeKeyboard = new Keyboard()
  .text('–ü–æ—Ü–µ–ª—É–π S ‚òÅ').row()
  .text('–ü–æ—Ü–µ–ª—É–π L üçì').row()
  .text('–ü–æ—Ü–µ–ª—É–π XXL üòà').row()
  .text('–°—Ä–æ—á–Ω—ã–µ –æ–±–Ω–∏–º–∞—à–∫–∏ üß∏').row()
  .text('–û–±—ä—è—Ç–∏—è XL ‚ù§Ô∏è').row()
  .text('–¢–µ—Å—Ç –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π) ‚ú®').row()
  .text('–ü—Ä–æ–≥–Ω–æ–∑ –∏ —Å–æ–≤–µ—Ç –Ω–∞ –¥–µ–Ω—å ü™Ñ').row()
  .text('üîô –ù–∞–∑–∞–¥')
  .resized();

const paidKeyboard = new Keyboard()
  .text('–ó–∞–≤–∞—Ä–∏—Ç—å —á–∞–π/–∫–æ—Ñ–µ ‚òïü´ñ').row()
  .text('–ë—ã—Å—Ç—Ä—ã–π –≤–∫—É—Å–Ω—ã–π –ø–µ—Ä–µ–∫—É—Å ü•ê').row()
  .text('–ú–∞—Å—Å–∞–∂ üíÜ').row()
  .text('–ú–µ–º—á–∏–∫ üêí').row()
  .text('üîô –ù–∞–∑–∞–¥')
  .resized();

// –ö–æ–º–∞–Ω–¥—ã
bot.command('start', async (ctx) => {
  await ctx.replyWithAnimation('CgACAgIAAxkBAAORaGjGMi2dp6DzsgZN-ccqxMOFA5IAAgV1AAIfj0hLA9gAARgwJwhCNgQ');
  await ctx.reply('–ü—Ä–∏–≤–µ—Ç, –ª—é–±–∏–º–∫–∞! üíì –ó–¥–µ—Å—å —Ç—ã –º–æ–∂–µ—à—å –≤—ã–±—Ä–∞—Ç—å, —á—Ç–æ —Ç–µ–±–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å, –∞ —è –ø—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞—é —ç—Ç–æ ‚ú® üëâüëà –¢–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º —è —Ö–æ—á—É –≤—ã—Ä–∞–∑–∏—Ç—å —Å–≤–æ—é –ª—é–±–æ–≤—å –∫ —Ç–µ–±–µ üíì –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —É—Å–ª—É–≥–∏ –ø–ª–∞—Ç–Ω—ã–µ üòâ', {
    reply_markup: mainKeyboard
  });
});

bot.hears('–ë–µ—Å–ø–ª–∞—Ç–Ω–æüíì', async (ctx) => ctx.reply('–í—ã–±–∏—Ä–∞–π:', { reply_markup: freeKeyboard }));

bot.hears('–ü–ª–∞—Ç–Ω–æü´∞', async (ctx) => ctx.reply('–í–æ—Ç –ø–ª–∞—Ç–Ω—ã–µ –æ–ø—Ü–∏–∏, –º–∏–ª–∞—à–∫–∞ üòò', { reply_markup: paidKeyboard }));

const notifyAdmin = async (ctx, choice) => {
  await bot.api.sendMessage(ADMIN_ID, `üîî –ù–æ–≤—ã–π –∑–∞–∫–∞–∑: ${choice} –æ—Ç @${ctx.from.username || ctx.from.first_name}`);
};

// –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –æ–ø—Ü–∏–∏
const freeOptions = [
  '–ü–æ—Ü–µ–ª—É–π S ‚òÅ',
  '–ü–æ—Ü–µ–ª—É–π L üçì',
  '–ü–æ—Ü–µ–ª—É–π XXL üòà',
  '–°—Ä–æ—á–Ω—ã–µ –æ–±–Ω–∏–º–∞—à–∫–∏ üß∏',
  '–û–±—ä—è—Ç–∏—è XL ‚ù§Ô∏è',
  '–ú–∞—Å—Å–∞–∂ üíÜ',
  '–¢–µ—Å—Ç –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π) ‚ú®',
  '–ü—Ä–æ–≥–Ω–æ–∑ –∏ —Å–æ–≤–µ—Ç –Ω–∞ –¥–µ–Ω—å ü™Ñ'
];

bot.hears(freeOptions, async (ctx) => {
  const choice = ctx.message.text;
  switch (choice) {
    case '–ü–æ—Ü–µ–ª—É–π S ‚òÅ':
      await ctx.reply('–¢—ã –≤—ã–±—Ä–∞–ª –Ω–µ–∂–Ω—ã–π –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π üíã—á–º–æ–∫üíã –û–∂–∏–¥–∞–π! ‚ú®');
      break;
    case '–ü–æ—Ü–µ–ª—É–π L üçì':
      await ctx.reply('–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Å—è... –°–∞–º—ã–π —Å–æ—á–Ω—ã–π —Å—Ç—Ä–∞—Å—Ç–Ω—ã–π –ø–æ—Ü–µ–ª—É–π –¥–ª—è —Ç–µ–±—è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å üíã');
      break;
    case '–ü–æ—Ü–µ–ª—É–π XXL üòà':
      await ctx.replyWithPhoto('AgACAgIAAxkBAAOzaGjN0kS0tzJpqSXRW5_9waCvhfcAAuT3MRuABEhLR1K5SGOpWEkBAAMCAAN4AAM2BA');
      await ctx.reply('–ù—É —á—Ç–æ –∂... üí¶ –î–æ—Å—Ç–∞–≤–∞–π —Å–≤–æ–π –æ–≥—Ä–æ–º–Ω—ã–π üçå');
      break;
    case '–°—Ä–æ—á–Ω—ã–µ –æ–±–Ω–∏–º–∞—à–∫–∏ üß∏':
      await ctx.reply('–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –æ–±—ä—è—Ç–∏–π —É–∂–µ —Å–ø–µ—à–∏—Ç –∫ —Ç–µ–±–µ! üß∏üí´');
      break;
    case '–û–±—ä—è—Ç–∏—è XL ‚ù§Ô∏è':
      await ctx.reply('–ù–µ–∂–Ω—ã–µ, –æ–±–≤–æ–ª–∞–∫–∏–≤–∞—é—â–∏–µ, —Å –∑–∞–ø–∞—Å–æ–º –ª—é–±–≤–∏ ‚ù§Ô∏èü§ó');
      break;
    case '–ú–∞—Å—Å–∞–∂ üíÜ':
      await ctx.reply('–£—Å—Ç—Ä–∞–∏–≤–∞–π—Å—è –ø–æ—É–¥–æ–±–Ω–µ–µ... –ù–∞—á–∏–Ω–∞—é –º—è–≥–∫–∏–π —Ä–∞—Å—Å–ª–∞–±–ª—è—é—â–∏–π –º–∞—Å—Å–∞–∂ –ø–ª–µ—á –∏ —à–µ–∏ üå∏üíÜ‚Äç‚ôÄÔ∏è‚ú® –¢—ã –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—à—å –ø–æ–ª–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞!');
      break;
    case '–¢–µ—Å—Ç –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π) ‚ú®':
      await ctx.reply('üß† –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ...\n–¢—ã —Å–µ–≥–æ–¥–Ω—è ‚Äî —á—É–¥–æ! ‚ú® –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –ø–æ–±–æ–ª—å—à–µ —Ç–µ–ø–ª–∞ –∏ –≤–∫—É—Å–Ω—è—à–µ–∫ üòã');
      break;
      }
});

bot.hears('–¢–µ—Å—Ç –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π) ‚ú®', async (ctx) => {
  await ctx.reply('–ö–∞–∫ —Ç—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—à—å?', {
    reply_markup: new Keyboard().text('–û—Ç–ª–∏—á–Ω–æ').row().text('–£—Å—Ç–∞–ª').row().text('–ü–µ—á–∞–ª—å–Ω–æ').row().text('üîô –ù–∞–∑–∞–¥').resized()
  });
});

bot.hears('–ü—Ä–æ–≥–Ω–æ–∑ –∏ —Å–æ–≤–µ—Ç –Ω–∞ –¥–µ–Ω—å ü™Ñ', async (ctx) => {
  const userId = ctx.from.id.toString();
  const now = Date.now();
  const last = userAdviceTimestamps[userId];

  if (last && now - last < 86400000) {
    const hoursLeft = Math.ceil((86400000 - (now - last)) / (60 * 60 * 1000));
    return ctx.reply(`üåô –£–∂–µ –ø–æ–ª—É—á–∞–ª —Å–æ–≤–µ—Ç. –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ ${hoursLeft} —á.`);
  }

  const adviceList = [
        '–°–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω –º–∞–ª–µ–Ω—å–∫–∏—Ö —á—É–¥–µ—Å. –ù–µ —É–ø—É—Å–∫–∞–π —à–∞–Ω—Å —É–ª—ã–±–Ω—É—Ç—å—Å—è –º–∏—Ä—É! ‚ú®',
        '–¢—ã —Å–≤–µ—Ç–∏—à—å—Å—è –∏–∑–Ω—É—Ç—Ä–∏. –ü—É—Å—Ç—å —ç—Ç–æ –±—É–¥–µ—Ç —Ç–≤–æ–∏–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –æ—Ä—É–∂–∏–µ–º —Å–µ–≥–æ–¥–Ω—è üí´',
        '–°–æ–ª–Ω—Ü–µ —Å–µ–≥–æ–¥–Ω—è –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –Ω–µ–±–µ, –Ω–æ –∏ –≤ —Ç–µ–±–µ. –ü–æ–¥–µ–ª–∏—Å—å —Å–≤–æ–∏–º —Ç–µ–ø–ª–æ–º ‚Äî –∏ –æ–Ω–æ –≤–µ—Ä–Ω—ë—Ç—Å—è! üåû',
        '–í–æ–∑–º–æ–∂–Ω—ã –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—è—Ç–Ω–æ—Å—Ç–∏. –ë—É–¥—å –æ—Ç–∫—Ä—ã—Ç üåà',
        '–£–¥–∞—á–∞ –Ω–∞ —Ç–≤–æ–µ–π —Å—Ç–æ—Ä–æ–Ω–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –¥–µ–π—Å—Ç–≤—É–µ—à—å –º—è–≥–∫–æ, –Ω–æ —É–≤–µ—Ä–µ–Ω–Ω–æ. –ù–µ —Ç–æ—Ä–æ–ø–∏—Å—å ‚Äî –ø—Ä–æ—Å—Ç–æ –∏–¥–∏ –≤–ø–µ—Ä—ë–¥ üçÄ',
        '–°–µ–≥–æ–¥–Ω—è –ª—É—á—à–µ –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–µ–±—è ‚Äî –≤—ã–±–µ—Ä–∏ –∑–∞–±–æ—Ç—É –æ —Å–µ–±–µ. –ú–∏—Ä –ø–æ–¥–æ–∂–¥—ë—Ç. –ù–µ –∑–∞–±—É–¥—å –æ—Ç–¥–æ—Ö–Ω—É—Ç—å –∏ –ø–æ–∫—É—à–∞—Ç—å ü•üü•ó',
        '–í—Å—ë, —á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å —Å –ª—é–±–æ–≤—å—é, –ø—Ä–∏–Ω–µ—Å—ë—Ç —É–¥–∞—á—É. –°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ —Ö–æ—Ä–æ—à–µ–º –∏ –æ–Ω–æ –ø—Ä–∏—É–º–Ω–æ–∂–∏—Ç—Å—è ü¶ã',
        '–¢–≤–æ—è —É–ª—ã–±–∫–∞ ‚Äî –º–∞–≥–Ω–∏—Ç –¥–ª—è –¥–æ–±—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π. –ù–µ –∑–∞–±—ã–≤–∞–π –≤–∫–ª—é—á–∏—Ç—å –µ—ë —É—Ç—Ä–æ–º üíå',
        '–≠—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –∫–∞–∫ –ª—ë–≥–∫–∏–π –≤–µ—Ç–µ—Ä: –Ω–µ–∂–Ω—ã–π –∏ —Å–≤–µ–∂–∏–π ‚òÅ'
      ];

  const message = adviceList[Math.floor(Math.random() * adviceList.length)];
  await ctx.reply(message);
  userAdviceTimestamps[userId] = now;
  saveAdviceTimestamps();
});

// –ü–ª–∞—Ç–Ω—ã–µ
bot.hears('–ó–∞–≤–∞—Ä–∏—Ç—å —á–∞–π/–∫–æ—Ñ–µ ‚òïü´ñ', async (ctx) => {
  await ctx.replyWithPhoto('AgACAgIAAxkBAAO-aGjRaZA5IBMNjLKdwPwwm7mkx14AApLzMRsfj0hL5u0B22DBZf0BAAMCAAN4AAM2BA');
  await ctx.reply('–° —Ç–µ–±—è 3 –ø–æ—Ü–µ–ª—É–π—á–∏–∫–∞ üíãüíãüíã –ß–∞–π –∏–ª–∏ –∫–æ—Ñ–µ?', {
    reply_markup: new Keyboard().text('–ß–∞–π üçµ').text('–ö–æ—Ñ–µ ‚òï').resized()
  });
  await notifyAdmin(ctx, '–ó–∞–≤–∞—Ä–∏—Ç—å —á–∞–π/–∫–æ—Ñ–µ ‚òïü´ñ');
});

bot.hears('–ë—ã—Å—Ç—Ä—ã–π –≤–∫—É—Å–Ω—ã–π –ø–µ—Ä–µ–∫—É—Å ü•ê', async (ctx) => {
  await ctx.replyWithPhoto('AgACAgIAAxkBAAPAaGjSNVbTEQABMkxakC447CTtEtA1AAII8TEbSUdIS_LpQaRT8nNjAQADAgADeAADNgQ');
  await ctx.reply('–≠—Ç–æ —Ç–µ–±–µ –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å 5 –ø–æ—Ü–µ–ª—É–π—á–∏–∫–æ–≤ üíãüíãüíãüíãüíã');
  await notifyAdmin(ctx, '–ë—ã—Å—Ç—Ä—ã–π –≤–∫—É—Å–Ω—ã–π –ø–µ—Ä–µ–∫—É—Å ü•ê');
});

bot.hears('–ú–∞—Å—Å–∞–∂ üíÜ', async (ctx) => {
  await ctx.reply('–£—Å—Ç—Ä–∞–∏–≤–∞–π—Å—è –ø–æ—É–¥–æ–±–Ω–µ–µ... –ù–∞—á–∏–Ω–∞—é –º—è–≥–∫–∏–π —Ä–∞—Å—Å–ª–∞–±–ª—è—é—â–∏–π –º–∞—Å—Å–∞–∂ –ø–ª–µ—á –∏ —à–µ–∏ üå∏üíÜ‚Äç‚ôÄÔ∏è‚ú® –¢—ã –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—à—å –ø–æ–ª–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞!');
  await notifyAdmin(ctx, '–ú–∞—Å—Å–∞–∂ üíÜ');
});

bot.hears('–ú–µ–º—á–∏–∫ üêí', async (ctx) => {
  const userId = ctx.from.id.toString();
  const index = userMemeIndex[userId] || 0;

  await ctx.replyWithPhoto(memePhotos[index]);
  await ctx.reply('–° —Ç–µ–±—è –æ–ø–ª–∞—Ç–∞ –≤ –≤–∏–¥–µ —É–ª—ã–±–∫–∏ üòä –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –µ—â—ë ‚Äî –∂–º–∏ –µ—â—ë —Ä–∞–∑!');

  userMemeIndex[userId] = (index + 1) % memePhotos.length;
  saveMemeIndex();
});

bot.hears(['–ß–∞–π üçµ', '–ö–æ—Ñ–µ ‚òï'], async (ctx) => {
  await ctx.reply('–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç! ‚ù§Ô∏è', {
    reply_markup: new Keyboard().text('üîô –ù–∞–∑–∞–¥').resized()
  });
});

bot.hears('üîô –ù–∞–∑–∞–¥', async (ctx) => {
  await ctx.reply('–¢—ã –≤–µ—Ä–Ω—É–ª—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é üíì –í—ã–±–∏—Ä–∞–π —Å–Ω–æ–≤–∞:', {
    reply_markup: mainKeyboard
  });
});

const moodKeyboard = new Keyboard()
  .text('–û—Ç–ª–∏—á–Ω–æ').row()
  .text('–£—Å—Ç–∞–ª').row()
  .text('–ü–µ—á–∞–ª—å–Ω–æ').row()
  .text('üîô –ù–∞–∑–∞–¥')
  .resized();

// –û—Ç–≤–µ—Ç—ã –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
const moodResponses = {
  '–û—Ç–ª–∏—á–Ω–æ': [
    '–û—Å—Ç–∞–Ω–æ–≤–∏—Å—å –Ω–∞ –º–∏–Ω—É—Ç—É –∏ –ø—Ä–æ—Å—Ç–æ –ø–æ—á—É–≤—Å—Ç–≤—É–π: ¬´–ú–Ω–µ —Ö–æ—Ä–æ—à–æ¬ª. –≠—Ç–æ –≤–µ–¥—å —Ç–∞–∫ –≤–∞–∂–Ω–æ! ‚òÄÔ∏è',
    '–ü–æ–¥–µ–ª–∏—Å—å —Å–≤–æ–∏–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º ‚Äî –≤–µ—Ä–Ω—ë—Ç—Å—è –≤–¥–≤–æ–π–Ω–µ ‚ú®',
    '–ó–∞–∫—Ä–æ–π –≥–ª–∞–∑–∞ –∏ –∑–∞–ø–æ–º–Ω–∏ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç. –û–Ω —Å—Ç–∞–Ω–µ—Ç —Ç–≤–æ–∏–º –ª–∏—á–Ω—ã–º —è–∫–æ—Ä–µ–º —Å—á–∞—Å—Ç—å—è üçÄ',
    '–•–æ—á–µ—à—å –µ—â—ë –±–æ–ª—å—à–µ —Ä–∞–¥–æ—Å—Ç–∏? –ü–æ–¥—É–º–∞–π, –∑–∞ —á—Ç–æ —Ç—ã –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å ü™ê'
  ],
  '–£—Å—Ç–∞–ª': [
    '–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã –ª–µ–∂–∏—à—å –≤ —Ç—Ä–∞–≤–µ, –∏ –Ω–∞–¥ —Ç–æ–±–æ–π –ø–ª—ã–≤—É—Ç –æ–±–ª–∞–∫–∞. –ü—Ä–æ—Å—Ç–æ –ø–æ–±—É–¥—å —Ç–∞–º üåø',
    '–°–¥–µ–ª–∞–π —Å–µ–±–µ —Ç—ë–ø–ª—ã–π —á–∞–π (–∏–ª–∏ –∑–∞–∫–∞–∂–∏ –ø—Ä—è–º–æ –∑–¥–µ—Å—å üòâ). –ü–æ—Å—Ç–∞–≤—å –Ω–∞ –ø–∞—É–∑—É. –ú–∏—Ä –ø–æ–¥–æ–∂–¥—ë—Ç. ‚òï',
    '–°–¥–µ–ª–∞–π –≤–¥–æ—Ö –Ω–∞ 4 —Å–µ–∫—É–Ω–¥—ã, –∑–∞–¥–µ—Ä–∂–∏ –Ω–∞ 4 —Å–µ–∫—É–Ω–¥—ã, –∑–∞—Ç–µ–º –≤—ã–¥–æ—Ö–Ω–∏ –∑–∞ 6 —Å–µ–∫—É–Ω–¥. –ü–æ–≤—Ç–æ—Ä–∏ 5 —Ä–∞–∑. –ú–µ–¥–ª–µ–Ω–Ω–æ... —Å–ø–æ–∫–æ–π–Ω–æ... üå¨Ô∏è'
  ],
  '–ü–µ—á–∞–ª—å–Ω–æ': [
    '–¢—ã –Ω–µ –æ–¥–∏–Ω, —è –∑–¥–µ—Å—å, —Å —Ç–æ–±–æ–π. –í—Å–µ–≥–¥–∞ ‚ù§Ô∏è. –ü–æ–ø—ã—Ç–∞–π—Å—è –ø–æ–¥—É–º–∞—Ç—å. —á—Ç–æ —É–∂–µ —Ö–æ—Ä–æ—à–µ–≥–æ —Å —Ç–æ–±–æ–π –ø—Ä–æ–∏–∑–æ—à–ª–æ –∏ —á–µ–≥–æ —Ç—ã –¥–æ—Å—Ç–∏–≥ ‚òÄ. –ò –ø–æ–º–Ω–∏, —Ç—ã —Å–∏–ª—å–Ω–µ–µ, —á–µ–º —Ç—ã –¥—É–º–∞–µ—à—å. –ò –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ —É–¥–∞—á–ª–∏–≤—ã–π üçÄ‚ú®',
    '–ü–æ–ø—Ä–æ–±—É–π —É–ª—ã–±–Ω—É—Ç—å—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è - —ç—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —ç–º–æ—Ü–∏–∏ ‚òÄ‚ù§Ô∏è',
    '–ü–µ—á–∞–ª—å - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –µ—ë, –∞ —è –≥–æ—Ç–æ–≤–∞ –ø–æ–º–æ—á—å –Ω–∞–π—Ç–∏ —Ç–µ–±–µ —Å–≤–µ—Ç (–µ—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–∂–µ—à—å –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–æ –º–Ω–æ–π —Å–≤–æ–∏–º–∏ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è–º–∏). –¢—ã –Ω–µ –æ–¥–∏–Ω üíìüë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë®',
    '–°–¥–µ–ª–∞–π –≤–¥–æ—Ö –Ω–∞ 4 —Å–µ–∫—É–Ω–¥—ã, –∑–∞–¥–µ—Ä–∂–∏ –Ω–∞ 4 —Å–µ–∫—É–Ω–¥—ã, –∑–∞—Ç–µ–º –≤—ã–¥–æ—Ö–Ω–∏ –∑–∞ 6 —Å–µ–∫—É–Ω–¥. –ü–æ–≤—Ç–æ—Ä–∏ 5 —Ä–∞–∑. –ú–µ–¥–ª–µ–Ω–Ω–æ... —Å–ø–æ–∫–æ–π–Ω–æ... üå¨Ô∏è'
  ]
};

// –ö–æ–º–∞–Ω–¥–∞ "–¢–µ—Å—Ç –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π) ‚ú®"
bot.hears('–¢–µ—Å—Ç –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π) ‚ú®', async (ctx) => {
  await ctx.reply('–ö–∞–∫ —Ç—ã —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—à—å?', {
    reply_markup: moodKeyboard
  });
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
bot.hears(['–û—Ç–ª–∏—á–Ω–æ', '–£—Å—Ç–∞–ª', '–ü–µ—á–∞–ª—å–Ω–æ'], async (ctx) => {
  const mood = ctx.message.text;
  const options = moodResponses[mood];
  const random = options[Math.floor(Math.random() * options.length)];

  await ctx.reply(random, {
    reply_markup: new Keyboard()
      .text('üîô –ù–∞–∑–∞–¥')
      .resized()
  });
});

bot.command('pingme', async (ctx) => {
  try {
    await bot.api.sendMessage(ADMIN_ID, 'üîî –¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ç–µ–±–µ –≤ –ª–∏—á–∫—É!');
    await ctx.reply('‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ—é –ª–∏—á–∫—É!');
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ –õ–°:', error);
    await ctx.reply('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–∏—á–∫—É.');
  }
});

// –ü–æ–ª—É—á–µ–Ω–∏–µ file_id
bot.on('message:animation', async (ctx) => {
  const fileId = ctx.message.animation.file_id;
  await ctx.reply(`file_id —ç—Ç–æ–π –≥–∏—Ñ–∫–∏: ${fileId}`);
});

bot.on('message:photo', async (ctx) => {
  const fileId = ctx.message.photo.at(-1).file_id;
  await ctx.reply(`file_id —ç—Ç–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏: ${fileId}`);
});

// === –ü—É–±–ª–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ —Ä–µ–∂–∏–º –æ–∂–∏–¥–∞–Ω–∏—è ===

let waitingForPost = false;

// –í—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞
bot.command('post', async (ctx) => {
  if (ctx.from.id !== ADMIN_ID) return;

  waitingForPost = true;
  await ctx.reply('üìù –í–≤–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å. –ß—Ç–æ–±—ã –æ—Ç–º–µ–Ω–∏—Ç—å ‚Äî –Ω–∞–ø–∏—à–∏ "–æ—Ç–º–µ–Ω–∞".');
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
bot.on('message:text', async (ctx) => {
  if (ctx.from.id !== ADMIN_ID) return;

  if (!waitingForPost) return;

  const text = ctx.message.text.trim();

  if (text.toLowerCase() === '–æ—Ç–º–µ–Ω–∞') {
    waitingForPost = false;
    return await ctx.reply('‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ. –¢—ã –≤—ã—à–µ–ª –∏–∑ —Ä–µ–∂–∏–º–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.');
  }

  try {
    await ctx.reply('‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è—é –ø–æ—Å—Ç...');
    // –ó–¥–µ—Å—å —Ç—ã –º–æ–∂–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å, –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–∞–Ω–∞–ª –∏–ª–∏ –≥—Ä—É–ø–ø–µ)
    await ctx.reply(text);
    waitingForPost = false;
  } catch (err) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Å—Ç–∞:', err);
    await ctx.reply('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–æ—Å—Ç–∞.');
  }
});

bot.on('message', async (ctx) => {
  console.log('ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', ctx.from.id);
});


// –ó–∞–ø—É—Å–∫
bot.start();
console.log('–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω ‚úÖ');
